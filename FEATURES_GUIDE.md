# 🎉 NodeCrypt 新功能使用指南

## 📋 功能概述

本次更新为 NodeCrypt 加密聊天应用添加了三个主要功能:

### 1. 🎤 语音消息
### 2. ⏱️ 自动销毁时间选择
### 3. 🔄 消息撤回

---

## 🎤 语音消息功能

### 使用方法:
1. **开始录制**: 点击输入框左侧的麦克风图标 🎤
2. **录制中**: 按钮会变红并显示脉冲动画
3. **停止并发送**: 再次点击麦克风图标

### 技术特性:
- ✅ 使用 WebRTC MediaRecorder API
- ✅ 音频格式: WebM
- ✅ 自动转换为 Base64 进行加密传输
- ✅ 支持公开和私密聊天
- ✅ 与其他消息类型一样支持端到端加密

### 注意事项:
- 首次使用需要授权麦克风权限
- 录音质量取决于设备麦克风
- 建议在安静环境下录制

---

## ⏱️ 自动销毁时间选择

### 使用方法:
1. **激活功能**: 点击时钟图标 ⏱️
   - 按钮变红表示已激活
2. **选择时间**: 在弹出菜单中选择销毁时间
   - 10秒
   - 30秒 (默认)
   - 1分钟
   - 5分钟
   - 10分钟
3. **发送消息**: 发送的所有消息都会带有倒计时
4. **关闭功能**: 再次点击时钟图标

### 视觉反馈:
- 📍 消息右上角显示倒计时徽章 (如 "25s")
- 🔴 红色脉冲动画提醒即将销毁
- 💥 时间到达后消息自动消失

### 技术实现:
- 前端倒计时显示
- 过期消息自动从DOM移除
- 刷新页面时过期消息不会重新显示

---

## 🔄 消息撤回功能

### 使用方法:
1. **触发菜单**: 
   - 💻 **电脑**: 长按鼠标左键 (500毫秒)
   - 📱 **手机**: 长按触摸 (500毫秒)
2. **选择操作**:
   - **撤回消息**: 只对自己发送的消息可用
   - **复制**: 对所有消息可用

### 撤回效果:
- 消息内容变为: "_你撤回了一条消息_" (斜体灰色)
- 消息气泡透明度降低
- 系统提示撤回成功

### 复制功能:
- 自动复制消息文本到剪贴板
- 支持现代浏览器的 Clipboard API
- 兼容旧版浏览器的 fallback 方案

---

## 🎨 UI/UX 改进

### 视觉效果:
- 🌈 流畅的过渡动画
- 💫 按钮悬停和点击反馈
- 🎯 清晰的视觉状态指示
- 🎪 优雅的弹出菜单

### 交互设计:
- 👆 直观的手势操作
- ⚡ 快速响应用户操作
- 🔒 防误触设计
- 📐 移动端适配

---

## 🔧 技术栈

### 前端技术:
- Vanilla JavaScript (ES6+)
- CSS3 Animations & Transitions
- WebRTC Media API
- Clipboard API

### 新增文件:
```
client/js/
├── util.voice.js      # 语音录制模块
├── util.recall.js     # 消息撤回模块
└── main.js           # 集成所有新功能

client/css/
└── style.css         # 新增 170+ 行样式
```

---

## 📊 兼容性

| 功能 | Chrome | Firefox | Safari | Edge |
|------|--------|---------|--------|------|
| 语音消息 | ✅ | ✅ | ✅ | ✅ |
| 自动销毁 | ✅ | ✅ | ✅ | ✅ |
| 消息撤回 | ✅ | ✅ | ✅ | ✅ |

### 移动端支持:
- ✅ iOS Safari
- ✅ Chrome Mobile
- ✅ Firefox Mobile
- ✅ Samsung Internet

---

## 🚀 快速开始

```bash
# 拉取最新代码
git pull origin main

# 安装依赖 (如果还没安装)
npm install

# 启动开发服务器
npm run dev

# 或部署到 Cloudflare Workers
npm run deploy
```

---

## 📝 更新日志

### v1.1.0 (2025-12-09)
- ✨ 新增语音消息功能
- ⏱️ 自动销毁支持时间选择
- 🔄 长按消息撤回和复制
- 🎨 UI/UX 全面优化
- 📱 完善移动端体验

---

## 🤝 贡献

感谢为这些功能做出贡献!

---

## 📄 许可证

ISC License

---

## 🔗 相关链接

- GitHub: https://github.com/jensenmasan/NodeCrypt
- Issues: https://github.com/jensenmasan/NodeCrypt/issues

---

**享受更安全、更便捷的加密聊天体验! 🔐💬**
