<!DOCTYPE html>
<html lang="zh-CN">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>é©¬è€å¸ˆNodeCrypt</title>
	<link rel="stylesheet" href="css/style.css">
	<link rel="stylesheet" href="css/body.css">
	<link rel="stylesheet" href="css/call.css">
	<link rel="stylesheet" href="css/phone.css">
	<link rel="stylesheet" href="css/form-animation.css">
	<link rel="stylesheet" href="css/login-3d-integration.css">
	<link rel="stylesheet" href="css/effects.css">
	<link rel="icon" type="image/svg+xml" href="assets/favicon.svg">
	<meta name="description"
		content="NodeCrypt - True end-to-end encrypted chat system, no database, all messages encrypted locally, server only relays encrypted data, supports Cloudflare Workers, Docker, self-hosting and local development.">
	<meta name="keywords"
		content="end-to-end encryption, security, chat, WebSocket, Cloudflare Workers, JavaScript, E2EE, anonymous communication, AES, ECDH, RSA, ChaCha20, security, open source, NodeCrypt, shuaiplus">
	<meta name="author" content="shuaiplus">
	<meta property="og:title" content="NodeCrypt - End-to-End Encrypted Chat System">
	<meta property="og:description"
		content="NodeCrypt is a zero-knowledge, end-to-end encrypted open source chat system where all encryption and decryption is done locally on the client side, and servers cannot access plaintext. Supports multi-platform deployment, secure, anonymous, no message history.">
	<meta property="og:type" content="website">
	<meta property="og:url" content="https://github.com/shuaiplus/NodeCrypt">
	<meta property="og:image" content="https://crypt.works/client/assets/favicon.svg">
	<meta name="twitter:card" content="summary_large_image">
	<meta name="twitter:title" content="NodeCrypt - End-to-End Encrypted Chat System">
	<meta name="twitter:description"
		content="NodeCrypt is a zero-knowledge, end-to-end encrypted open source chat system where all encryption and decryption is done locally on the client side, and servers cannot access plaintext.">
	<meta name="twitter:image" content="https://crypt.works/client/assets/favicon.svg">
	<meta name="google-site-verification" content="2KGYZcUDyYzGVeYAQ9mMRUGcTiMyZqFF6D7232SyGgw" />
	<style>
		/* æ·»åŠ ä¸€ä¸ªé¢„åŠ è½½æ ·å¼ï¼Œé¿å…é—ªçƒ */
		.preload * {
			-webkit-transition: none !important;
			-moz-transition: none !important;
			-ms-transition: none !important;
			-o-transition: none !important;
			transition: none !important;
		}
	</style>
	<!-- å¼•å…¥ Three.js å’Œ MediaPipe -->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js" crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@mediapipe/control_utils/control_utils.js"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@mediapipe/drawing_utils/drawing_utils.js"
		crossorigin="anonymous"></script>
	<script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js" crossorigin="anonymous"></script>
	<link rel="stylesheet" href="css/gesture-bg.css">
	<link rel="stylesheet" href="css/context-menu.css">
</head>

<body class="preload">
	<!-- 3D æ‰‹åŠ¿äº¤äº’ UI å…ƒç´  -->
	<div id="loading">ç³»ç»Ÿåˆå§‹åŒ–ä¸­... (è¯·å…è®¸æ‘„åƒå¤´æƒé™)</div>
	<div id="ui-layer">
		<h1>3D ç²’å­æ‰‹åŠ¿äº¤äº’</h1>
		<p>
			å½“å‰æ‰‹åŠ¿: <span id="gesture-status" class="status">æ— </span><br>
			æ‰©æ•£ç¨‹åº¦: <span id="spread-status" class="status">0%</span>
		</p>
		// æ›¿æ¢åŸæœ‰è¯´æ˜æ–‡å­—ï¼Œå¢åŠ æ§åˆ¶é¢æ¿
		æ‰‹åŠ¿ 1-3: æ–‡å­—å˜æ¢ | ğŸ¤Ÿ: çˆ±å¿ƒ | ğŸ–: 2025<br>
		å¼ åˆæ‰‹æŒ‡æ§åˆ¶ç²’å­æ‰©æ•£
		</p>

		<!-- æ–°å¢æ§åˆ¶é¢æ¿ -->
		<!-- æ–°å¢ï¼šåˆ‡æ°´æœæ¸¸æˆ UI -->


		<!-- æ”¹è¿›çš„æ§åˆ¶é¢æ¿ -->
		<div class="control-panel" id="main-control-panel">
			<div class="panel-section">
				<label>åŸºç¡€æ¨¡å‹</label>
				<div class="btn-group scroll-group">
					<button class="model-btn" data-model="HEART">â¤ï¸ çˆ±å¿ƒ</button>
					<button class="model-btn" data-model="FLOWER">ğŸŒ¸ èŠ±æœµ</button>
					<button class="model-btn" data-model="SATURN">ğŸª åœŸæ˜Ÿ</button>
					<button class="model-btn" data-model="BUDDHA">ğŸ§˜ ä½›åƒ</button>
					<button class="model-btn" data-model="FIREWORKS">ğŸ† çƒŸèŠ±</button>
				</div>
			</div>

			<div class="panel-section">
				<label>12 æ˜Ÿåº§</label>
				<div class="btn-group scroll-group constellation-group">
					<button class="model-btn" data-model="ARIES">â™ˆ ç™½ç¾Š</button>
					<button class="model-btn" data-model="TAURUS">â™‰ é‡‘ç‰›</button>
					<button class="model-btn" data-model="GEMINI">â™Š åŒå­</button>
					<button class="model-btn" data-model="CANCER">â™‹ å·¨èŸ¹</button>
					<button class="model-btn" data-model="LEO">â™Œ ç‹®å­</button>
					<button class="model-btn" data-model="VIRGO">â™ å¤„å¥³</button>
					<button class="model-btn" data-model="LIBRA">â™ å¤©ç§¤</button>
					<button class="model-btn" data-model="SCORPIO">â™ å¤©è</button>
					<button class="model-btn" data-model="SAGITTARIUS">â™ å°„æ‰‹</button>
					<button class="model-btn" data-model="CAPRICORN">â™‘ æ‘©ç¾¯</button>
					<button class="model-btn" data-model="AQUARIUS">â™’ æ°´ç“¶</button>
					<button class="model-btn" data-model="PISCES">â™“ åŒé±¼</button>
				</div>
			</div>

			<div class="panel-row"
				style="margin-top: 10px; display: flex; align-items: center; justify-content: space-between;">
				<div>
					<label style="margin-bottom: 2px;">ç²’å­é¢œè‰²</label>
					<input type="color" id="particle-color" value="#00d9ff">
				</div>
			</div>
		</div>

		<button id="fullscreen-btn" class="fullscreen-btn" title="å…¨å±æ¨¡å¼">
			<svg width="24" height="24" viewBox="0 0 24 24" fill="none" class="fullscreen-icon">
				<path d="M4 8V4m0 0h4M4 4l5 5m11-5v4m0-4h-4m4 4l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5v-4m0 4h-4m4-4l-5-5"
					stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
			</svg>
		</button>
	</div>
	<div id="video-container">
		<video id="input-video"></video>
	</div>
	<div id="canvas-container"></div>

	<div id="start-screen" class="start-screen">
		<button id="start-login-btn" class="start-login-btn" style="display: none; opacity: 0; transform: scale(0.8);">
			<span>è¿›å…¥ç³»ç»Ÿ</span>
			<div class="btn-glow"></div>
		</button>
	</div>

	<!-- ç™»å½•å®¹å™¨ï¼Œé»˜è®¤éšè—ï¼Œç‚¹å‡»æŒ‰é’®åæ˜¾ç¤º -->
	<div class="login-container" id="login-container" style="display: none; opacity: 0;">
		<!-- ç¿»è½¬å¡ç‰‡å®¹å™¨ -->
		<div class="flip-card" id="flip-card">
			<div class="flip-card-inner">
				<!-- å¡ç‰‡æ­£é¢ - ç™»å½•è¡¨å• -->
				<div class="flip-card-front"> <!-- å¸®åŠ©æŒ‰é’® -->
					<button class="help-btn" id="help-btn" type="button" data-i18n-title="help.usage_guide">
						<svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
							<circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="2" />
							<path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3" stroke="currentColor" stroke-width="2"
								stroke-linecap="round" stroke-linejoin="round" />
							<circle cx="12" cy="17" r="1" fill="currentColor" />
						</svg>
					</button>
					<h1 id="login-title"></h1>
					<form id="login-form">
						<!-- ç™»å½•è¡¨å•å†…å®¹å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
						<!-- Login form content will be dynamically generated by JavaScript -->
					</form>
				</div> <!-- å¡ç‰‡èƒŒé¢ - ä½¿ç”¨è¯´æ˜ -->
				<div class="flip-card-back">
					<button class="help-btn back-btn" id="back-btn" type="button" data-i18n-title="help.back_to_login">
						<svg width="40" height="40" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
							<path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round"
								stroke-linejoin="round" />
						</svg>
					</button>
					<h2 data-i18n="help.usage_guide"></h2>
					<div class="help-content">
						<div class="help-section">
							<h3 data-i18n="help.what_is_nodecrypt"></h3>
							<p data-i18n="help.what_is_nodecrypt_desc"></p>
						</div>

						<div class="help-section">
							<h3 data-i18n="help.how_to_start"></h3>
							<ol>
								<li>
									<strong data-i18n="help.step_username"></strong>ï¼š
									<span data-i18n="help.step_username_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.step_node_name"></strong>ï¼š
									<span data-i18n="help.step_node_name_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.step_password"></strong>ï¼š
									<span data-i18n="help.step_password_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.step_join"></strong>ï¼š
									<span data-i18n="help.step_join_desc"></span>
								</li>
							</ol>
							<div class="help-important">
								<strong data-i18n="help.important_note"></strong>ï¼š<span
									data-i18n="help.room_isolation_note"></span>
							</div>
						</div>

						<div class="help-section">
							<h3 data-i18n="help.security_features"></h3>
							<ul>
								<li>
									<strong data-i18n="help.e2e_encryption"></strong>ï¼š
									<span data-i18n="help.e2e_encryption_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.password_enhanced_encryption"></strong>ï¼š
									<span data-i18n="help.password_enhanced_encryption_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.no_history"></strong>ï¼š
									<span data-i18n="help.no_history_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.anonymous_communication"></strong>ï¼š
									<span data-i18n="help.anonymous_communication_desc"></span>
								</li>
								<li>
									<strong data-i18n="help.decentralized"></strong>ï¼š
									<span data-i18n="help.decentralized_desc"></span>
								</li>
							</ul>
						</div>

						<div class="help-section">
							<h3 data-i18n="help.usage_tips"></h3>
							<ul>
								<li><strong data-i18n="help.tip_private_chat"></strong>ï¼š<span
										data-i18n="help.tip_private_chat_desc"></span></li>
								<li><strong data-i18n="help.tip_group_chat"></strong>ï¼š<span
										data-i18n="help.tip_group_chat_desc"></span></li>
								<li><strong data-i18n="help.tip_security_reminder"></strong>ï¼š<span
										data-i18n="help.tip_security_reminder_desc"></span></li>
								<li><strong data-i18n="help.tip_password_strategy"></strong>ï¼š<span
										data-i18n="help.tip_password_strategy_desc"></span></li>
							</ul>
						</div>
					</div>
				</div>
			</div>
		</div>

	</div>
	<div class="container" id="chat-container" style="display:none;">
		<div class="mobile-sidebar-mask" id="mobile-sidebar-mask"></div>
		<div class="mobile-rightbar-mask" id="mobile-rightbar-mask"></div>
		<!-- Settings panel as a sidebar replacement -->
		<div class="settings-sidebar" id="settings-sidebar" style="display:none;">
			<div class="settings-header"> <button class="settings-back-btn" id="settings-back-btn" title=""
					aria-label="">
					<svg width="24px" height="24px" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
						<path d="M15 18L9 12L15 6" stroke="#808080" stroke-width="2" stroke-linecap="round"
							stroke-linejoin="round" />
					</svg>
				</button>
				<h2 class="settings-title" id="settings-title"></h2>
			</div>
			<div class="settings-content" id="settings-content">
				<!-- Settings content will be populated by JavaScript -->
			</div>
		</div>
		<div class="sidebar" id="sidebar">
			<div class="sidebar-user"> <span class="avatar" id="sidebar-user-avatar"></span> <span
					class="sidebar-username" id="sidebar-username"></span> <button class="settings-btn"
					id="settings-btn" title="" aria-label=""> <svg width="30px" height="30px" viewBox="0 0 24 24"
						fill="none" xmlns="http://www.w3.org/2000/svg">
						<g id="SVGRepo_bgCarrier" stroke-width="0"></g>
						<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
						<g id="SVGRepo_iconCarrier">
							<path fill-rule="evenodd" clip-rule="evenodd"
								d="M10.65 3L9.93163 3.53449L9.32754 5.54812L7.47651 4.55141L6.5906 4.68143L4.68141 6.59062L4.55139 7.47652L5.5481 9.32755L3.53449 9.93163L3 10.65V13.35L3.53449 14.0684L5.54811 14.6725L4.55142 16.5235L4.68144 17.4094L6.59063 19.3186L7.47653 19.4486L9.32754 18.4519L9.93163 20.4655L10.65 21H13.35L14.0684 20.4655L14.6725 18.4519L16.5235 19.4486L17.4094 19.3185L19.3186 17.4094L19.4486 16.5235L18.4519 14.6724L20.4655 14.0684L21 13.35V10.65L20.4655 9.93163L18.4519 9.32754L19.4486 7.47654L19.3186 6.59063L17.4094 4.68144L16.5235 4.55142L14.6725 5.54812L14.0684 3.53449L13.35 3H10.65ZM10.4692 6.96284L11.208 4.5H12.792L13.5308 6.96284L13.8753 7.0946C13.9654 7.12908 14.0543 7.16597 14.142 7.2052L14.4789 7.35598L16.7433 6.13668L17.8633 7.25671L16.644 9.52111L16.7948 9.85803C16.834 9.9457 16.8709 10.0346 16.9054 10.1247L17.0372 10.4692L19.5 11.208V12.792L17.0372 13.5308L16.9054 13.8753C16.8709 13.9654 16.834 14.0543 16.7948 14.1419L16.644 14.4789L17.8633 16.7433L16.7433 17.8633L14.4789 16.644L14.142 16.7948C14.0543 16.834 13.9654 16.8709 13.8753 16.9054L13.5308 17.0372L12.792 19.5H11.208L10.4692 17.0372L10.1247 16.9054C10.0346 16.8709 9.94569 16.834 9.85803 16.7948L9.52111 16.644L7.25671 17.8633L6.13668 16.7433L7.35597 14.4789L7.2052 14.142C7.16597 14.0543 7.12908 13.9654 7.0946 13.8753L6.96284 13.5308L4.5 12.792L4.5 11.208L6.96284 10.4692L7.0946 10.1247C7.12907 10.0346 7.16596 9.94571 7.20519 9.85805L7.35596 9.52113L6.13666 7.2567L7.25668 6.13667L9.5211 7.35598L9.85803 7.2052C9.9457 7.16597 10.0346 7.12908 10.1247 7.0946L10.4692 6.96284ZM14.25 12C14.25 13.2426 13.2426 14.25 12 14.25C10.7574 14.25 9.75 13.2426 9.75 12C9.75 10.7574 10.7574 9.75 12 9.75C13.2426 9.75 14.25 10.7574 14.25 12ZM15.75 12C15.75 14.0711 14.0711 15.75 12 15.75C9.92893 15.75 8.25 14.0711 8.25 12C8.25 9.92893 9.92893 8.25 12 8.25C14.0711 8.25 15.75 9.92893 15.75 12Z"
								fill="#808080"></path>
						</g>
					</svg> </button> </div>
			<div class="join-room"> <svg class="MuiSvgIcon-root icon-22-middle" focusable="false" viewBox="0 0 24 24"
					aria-hidden="true">
					<path
						d="M21 3.01H3c-1.1 0-2 .9-2 2V9h2V4.99h18v14.03H3V15H1v4.01c0 1.1.9 1.98 2 1.98h18c1.1 0 2-.88 2-1.98v-14c0-1.11-.9-2-2-2zM11 16l4-4-4-4v3H1v2h10v3z">
					</path>
				</svg> <span id="join-room-text"></span> </div>
			<div class="rooms" id="room-list"> </div>
		</div>
		<div class="main">
			<div class="main-header" id="main-header"> </div>
			<div class="chat-area" id="chat-area"> </div>
			<div class="chat-input-area">
				<div class="rows-wrapper chat-input-wrapper chat-input-main-wrapper chat-rows-wrapper">
					<div class="new-message-wrapper rows-wrapper-row" data-offset="commands"> <button
							class="chat-emoji-btn" type="button" title=""> <svg width="30px" height="30px"
								viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
								<g id="SVGRepo_bgCarrier" stroke-width="0"></g>
								<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
								<g id="SVGRepo_iconCarrier">
									<path fill-rule="evenodd" clip-rule="evenodd"
										d="M19.5 12C19.5 16.1421 16.1421 19.5 12 19.5C7.85786 19.5 4.5 16.1421 4.5 12C4.5 7.85786 7.85786 4.5 12 4.5C16.1421 4.5 19.5 7.85786 19.5 12ZM21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12ZM9.375 10.5C9.99632 10.5 10.5 9.99632 10.5 9.375C10.5 8.75368 9.99632 8.25 9.375 8.25C8.75368 8.25 8.25 8.75368 8.25 9.375C8.25 9.99632 8.75368 10.5 9.375 10.5ZM15.75 9.375C15.75 9.99632 15.2463 10.5 14.625 10.5C14.0037 10.5 13.5 9.99632 13.5 9.375C13.5 8.75368 14.0037 8.25 14.625 8.25C15.2463 8.25 15.75 8.75368 15.75 9.375ZM12 15C10.1783 15 9 13.8451 9 12.75H7.5C7.5 14.9686 9.67954 16.5 12 16.5C14.3205 16.5 16.5 14.9686 16.5 12.75H15C15 13.8451 13.8217 15 12 15Z"
										fill="#808080"></path>
								</g>
							</svg> </button>
						<button class="chat-voice-btn" id="chat-voice-btn" type="button" title="Send Voice Message">
							<svg width="26px" height="26px" viewBox="0 0 24 24" fill="none"
								xmlns="http://www.w3.org/2000/svg">
								<path
									d="M12 3C10.3431 3 9 4.34315 9 6V11C9 12.6569 10.3431 14 12 14C13.6569 14 15 12.6569 15 11V6C15 4.34315 13.6569 3 12 3Z"
									stroke="#808080" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M5 10V11C5 14.866 8.13401 18 12 18C15.866 18 19 14.866 19 11V10"
									stroke="#808080" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M12 18V22" stroke="#808080" stroke-width="2" stroke-linecap="round"
									stroke-linejoin="round" />
							</svg>
						</button>
						<button class="chat-destruct-btn" id="chat-destruct-btn" type="button"
							title="Autodestruct Messages">
							<svg width="26px" height="26px" viewBox="0 0 24 24" fill="none"
								xmlns="http://www.w3.org/2000/svg">
								<path
									d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z"
									stroke="#808080" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" />
								<path d="M12 6V12L16 14" stroke="#808080" stroke-width="2" stroke-linecap="round"
									stroke-linejoin="round" />
							</svg>
						</button>
						<div class="input-message-container">
							<div class="input-message-input is-empty scrollable scrollable-y no-scrollbar input-message-input-init"
								contenteditable="true" dir="auto" tabindex="-1"></div> <span
								class="input-field-placeholder i18n is-empty"></span>
							<div contenteditable="true" tabindex="-1"
								class="input-message-input is-empty scrollable scrollable-y no-scrollbar input-field-input-fake">
							</div> <button class="chat-attach-btn chat-attach-btn-abs" type="button" title=""> <svg
									width="30px" height="30px" viewBox="0 0 24 24" fill="none"
									xmlns="http://www.w3.org/2000/svg">
									<g id="SVGRepo_bgCarrier" stroke-width="0"></g>
									<g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
									<g id="SVGRepo_iconCarrier">
										<path fill-rule="evenodd" clip-rule="evenodd"
											d="M10.6875 3.75C8.96439 3.75 7.5 5.23565 7.5 7.15385L7.5 15.4615C7.5 18.1444 9.55201 20.25 12 20.25C14.448 20.25 16.5 18.1444 16.5 15.4615V7.15385H18V15.4615C18 18.8963 15.351 21.75 12 21.75C8.649 21.75 6 18.8963 6 15.4615L6 7.15385C6 4.48383 8.06137 2.25 10.6875 2.25C13.3136 2.25 15.375 4.48383 15.375 7.15385V15.4615C15.375 17.3669 13.9013 18.9808 12 18.9808C10.0987 18.9808 8.625 17.3669 8.625 15.4615V7.15385H10.125V15.4615C10.125 16.615 11.0018 17.4808 12 17.4808C12.9982 17.4808 13.875 16.615 13.875 15.4615V7.15385C13.875 5.23565 12.4106 3.75 10.6875 3.75Z"
											fill="#808080"></path>
									</g>
								</svg></button>
						</div> <input type="file" multiple class="input-hidden">
					</div>
				</div>
				<div class="send-message-btn">
					<span class="text">
						<img src="https://i.lxlad.com/file/1765344007721_image.png" alt="Send" width="22" height="22"
							style="display: block; pointer-events: none;">

					</span>
				</div>
			</div>
		</div>
		<div class="rightbar" id="rightbar">
			<div class="rightbar-header">
				<div class="rightbar-group">
					<div class="group-info">
						<div class="title" id="members-title"></div>
						<div class="group-desc" id="rightbar-group-desc"></div>
					</div>
				</div>
			</div>
			<div class="rightbar-tabs tabs" id="member-tabs"> </div>
			<div class="members" id="member-list"> </div>
		</div>
	</div>
	<script type="module" src="./js/main.js"></script>
	<script type="module">
		import { init3DGestureSystem, cleanup3DGestureSystem } from './js/background-3d.js';

		// å¯¼å‡ºåˆ°windowå¯¹è±¡ä¾›å…¶ä»–æ¨¡å—ä½¿ç”¨
		window.cleanup3DGestureSystem = cleanup3DGestureSystem;

		// ä»…åœ¨ç™»å½•é¡µåˆå§‹åŒ– (æ£€æŸ¥ login-container)
		if (document.getElementById('login-container')) {
			// ç¨å¾®å»¶è¿Ÿç¡®ä¿ DOM åŠ è½½
			setTimeout(() => {
				init3DGestureSystem();
			}, 100);

			// æ§åˆ¶â€œè¿›å…¥ç³»ç»Ÿâ€æŒ‰é’®é€»è¾‘
			const startBtn = document.getElementById('start-login-btn');
			const startScreen = document.getElementById('start-screen');
			const loginContainer = document.getElementById('login-container');

			if (startBtn && loginContainer) {
				// éšè—å¯åŠ¨æŒ‰é’®çš„æ˜¾ç¤ºé€»è¾‘ï¼šè¿ç»­ç‚¹å‡»3æ¬¡æ˜¾ç¤º
				let clickCount = 0;
				let clickTimer = null;

				document.addEventListener('click', (e) => {
					// å¦‚æœæŒ‰é’®å·²ç»æ˜¾ç¤ºæˆ–ç™»å½•æ¡†å·²æ˜¾ç¤ºï¼Œåˆ™ä¸å¤„ç†
					if (startBtn.style.display === 'block' || loginContainer.style.display === 'flex') return;

					// å¿½ç•¥åœ¨startBtnä¸Šçš„ç‚¹å‡»ï¼ˆè™½ç„¶å®ƒéšè—äº†ç‚¹ä¸åˆ°ï¼Œä½†ä¸ºäº†é€»è¾‘ä¸¥è°¨ï¼‰
					if (e.target === startBtn || startBtn.contains(e.target)) return;

					clickCount++;
					console.log('Click count:', clickCount);

					if (clickTimer) clearTimeout(clickTimer);

					if (clickCount >= 3) {
						// æ˜¾ç¤ºæŒ‰é’®
						startBtn.style.display = 'block';
						// å¼ºåˆ¶é‡æ’
						startBtn.offsetHeight;
						startBtn.style.opacity = '1';
						startBtn.style.transform = 'scale(1)';
						clickCount = 0; // é‡ç½®
					} else {
						// 1ç§’å†…æ²¡æœ‰ä¸‹ä¸€æ¬¡ç‚¹å‡»åˆ™é‡ç½®
						clickTimer = setTimeout(() => {
							clickCount = 0;
						}, 1000); // å®½æ¾ä¸€ç‚¹çš„æ—¶é—´çª—å£
					}
				});

				// è‡ªåŠ¨éšè—é€»è¾‘ï¼šæŒ‰é’®æ˜¾ç¤ºå10ç§’æ— æ“ä½œåˆ™éšè—
				// Auto-hide logic: Hide button if not clicked within 10 seconds after showing
				const autoHideButton = () => {
					if (window.btnHideTimer) clearTimeout(window.btnHideTimer);
					window.btnHideTimer = setTimeout(() => {
						// Double check if it's still visible
						if (startBtn.style.display === 'block' || startBtn.style.opacity === '1') {
							startBtn.style.transition = 'opacity 0.8s ease, transform 0.8s ease';
							startBtn.style.opacity = '0';
							startBtn.style.transform = 'scale(0.8)';
							setTimeout(() => {
								if (startBtn.style.opacity === '0') {
									startBtn.style.display = 'none';
								}
							}, 800);
						}
					}, 10000); // 10s
				};

				// åœ¨æŒ‰é’®æ˜¾ç¤ºçš„åœ°æ–¹è°ƒç”¨ autoHideButton
				const originalDisplay = startBtn.style.display;
				const observer = new MutationObserver((mutations) => {
					mutations.forEach((mutation) => {
						if (mutation.type === 'attributes' && mutation.attributeName === 'style') {
							// If button becomes visible
							const isVisible = startBtn.style.display === 'block' && startBtn.style.opacity !== '0';
							if (isVisible) {
								autoHideButton();
							}
						}
					});
				});
				observer.observe(startBtn, { attributes: true });

				startBtn.addEventListener('click', (e) => {
					e.stopPropagation(); // é˜²æ­¢å†’æ³¡è§¦å‘ä¸Šé¢çš„è®¡æ•°é€»è¾‘
					// æŒ‰é’®æ·¡å‡º
					// æŒ‰é’®æ·¡å‡º
					startBtn.style.transform = 'scale(1.5)';
					startBtn.style.opacity = '0';

					setTimeout(() => {
						if (startScreen) startScreen.style.display = 'none';

						// ç™»å½•æ¡†æ·¡å…¥
						loginContainer.style.display = 'flex';
						// å¼ºåˆ¶é‡æ’ä»¥è§¦å‘ transition
						loginContainer.offsetHeight;
						loginContainer.style.opacity = '1';
						loginContainer.style.transition = 'opacity 0.8s ease, transform 0.8s cubic-bezier(0.34, 1.56, 0.64, 1)';
						loginContainer.style.transform = 'scale(1)';
					}, 300);
				});

				// åˆå§‹åŒ–ç™»å½•æ¡†çŠ¶æ€ï¼ˆä¸ºäº†åŠ¨ç”»ï¼‰
				loginContainer.style.transform = 'scale(0.9)';
			}
		}
	</script>

	<!-- Context Menu Overlay and Menu -->
	<div class="context-menu-overlay" id="context-menu-overlay"></div>
	<div class="context-menu" id="message-context-menu">
		<div class="context-menu-item" data-action="copy">å¤åˆ¶</div>
		<div class="context-menu-item" data-action="zoom">æ”¾å¤§é˜…è¯»</div>
		<div class="context-menu-divider"></div>
		<div class="context-menu-item" data-action="translate">ç¿»è¯‘</div>
		<div class="context-menu-item" data-action="search">æœä¸€æœ</div>
		<div class="context-menu-item" data-action="forward">è½¬å‘..</div>
		<div class="context-menu-divider"></div>
		<div class="context-menu-item" data-action="favorite">æ”¶è—</div>
		<div class="context-menu-item" data-action="remind">æé†’</div>
		<div class="context-menu-item" data-action="multiselect">å¤šé€‰</div>
		<div class="context-menu-item" data-action="pin">ç½®é¡¶</div>
	</div>

	<!-- Zoom Reading Modal -->
	<div class="zoom-modal" id="zoom-modal">
		<div class="zoom-close" id="zoom-close">&times;</div>
		<div class="zoom-content" id="zoom-content"></div>
	</div>
</body>

</html>